class Solution {
    public int shipWithinDays(int[] weights, int D) {
        int low = 0, high = 0, mid = 0, n = weights.length;
        for(int x: weights){
            low = Math.max(low, x);
            high += x;
        }
        while (low < high) {
            mid = (high - low) / 2 + low;
            int sum = 0, day = 0;
            for(int x: weights) {
                if(sum + x > mid) {
                    day++;
                    sum = x;                    
                } else if (sum + x == mid) {
                    sum = 0;
                } else {
                    if (sum == 0) {
                        day++;
                        sum += x;
                    } else {
                        sum += x;
                    }
                }
            }
            if(day > D) {
                low = mid + 1;
            } else {
                high = mid;
            }
        }
        return high;
    }
}
